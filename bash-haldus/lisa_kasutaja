#!/bin/bash

# Kontrollime, kas skript käivitati juurkasutajana või vastavate õigustega

if [ "$(id -u)" -ne 0 ]; then
  echo "Skripti käivitamiseks on vajalik juurkasutaja õigus!" 
  exit 1
fi

# Kontrollime, kas anti parameeter (kasutajanimi)

if [ -z "$1" ]; then
  echo "Kasutage skripti järgmiselt: $0 <kasutajanimi>"
  exit 1
fi

kasutajanimi=$1

# Kontrollime, kas kasutaja juba eksisteerib

if id "$kasutajanimi" &>/dev/null; then
  echo "Kasutaja $kasutajanimi juba eksisteerib!"
  exit 1
fi

# Loome kasutaja ilma paroolita

useradd $kasutajanimi

# Loome kodukataloogi

mkhomedir_helper $kasutajanimi

# Kopeerime "skeleton" failid kodukataloogi

cp -r /etc/skel/. /home/$kasutajanimi/

# Andke vajalikud õigused kodukataloogile

chown -R $kasutajanimi:$kasutajanimi /home/$kasutajanimi

echo "Kasutaja $kasutajanimi loodud ilma paroolita ja kodukataloogiga /home/$kasutajanimi."
